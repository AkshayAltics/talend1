package routines;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;

import jxl.Sheet;
import jxl.Workbook;
import jxl.read.biff.BiffException;

import java.util.ArrayList;
import java.util.HashMap;

public class ExcelRoutines {

   
    public static void helloExample(String message) {
        if (message == null) {
            message = "World"; //$NON-NLS-1$
        }
        System.out.println("Hello " + message + " !"); //$NON-NLS-1$ //$NON-NLS-2$
    }
  
    
    
    public static void readExcel() throws BiffException, IOException {
		String FilePath = "F:\\Talend workspacce\\EMPExcelSampleData.xls";
		FileInputStream fs = new FileInputStream(FilePath);
		Workbook wb = Workbook.getWorkbook(fs);

		// TO get the access to the sheet
		Sheet sh = wb.getSheet(1);
		
		// To get the number of rows present in sheet
		ArrayList<HashMap<String, String>> myArrList = new ArrayList<HashMap<String, String>>();
	
		String shn[]=wb.getSheetNames();
		File fileoutput = new File("F:\\Talend workspacce\\testing_12062019.csv"); 
		
	
for(int s=0;s<wb.getSheetNames().length;s++)
{

		System.out.println("nothing "+shn[s]);

		sh=wb.getSheet(s);
		int totalNoOfRows = sh.getRows();
		// To get the number of columns present in sheet
		int totalNoOfCols = sh.getColumns();
		
		for (int row = 0; row < totalNoOfRows; row++)
		{
					HashMap<String, String> sheetdata = new HashMap<String, String>();
					
		           // String colname[] ={"ID","FirstName","LastName","City","State"};
					
					for (int col = 0; col < totalNoOfCols; col++) {
				
						String data = sh.getCell(col, row).getContents();
						String val = sh.getCell(col,0).getContents();
						sheetdata.put(val,data);
						
						//sb.append(",");
				     }
				System.out.println(sheetdata);
			
				myArrList.add(sheetdata);
				
				System.out.println("\t");
				sheetdata.clear();
			}
		
	    }



FileWriter writer;
writer = new FileWriter(FilePath, true);  //True = Append to file, false = Overwrite
for (int i = 0; i < myArrList.size(); i++)
{
	writer.write(myArrList.get(i).get("ID").toString());
	writer.write(",");
	writer.write(myArrList.get(i).get("FirstName").toString());
	writer.write(",");
	writer.write(myArrList.get(i).get("LastName").toString());
	writer.write(",");
	writer.write(myArrList.get(i).get("City").toString());
	writer.write(",");
	writer.write(myArrList.get(i).get("State").toString());
	writer.write("\r\n");
}

    }
 }
